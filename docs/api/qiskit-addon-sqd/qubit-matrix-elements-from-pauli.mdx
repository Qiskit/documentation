---
title: matrix_elements_from_pauli
description: API reference for qiskit_addon_sqd.qubit.matrix_elements_from_pauli
in_page_toc_min_heading_level: 1
python_api_type: function
python_api_name: qiskit_addon_sqd.qubit.matrix_elements_from_pauli
---

<span id="qiskit-addon-sqd-qubit-matrix-elements-from-pauli" />

# qiskit\_addon\_sqd.qubit.matrix\_elements\_from\_pauli

<Function id="qiskit_addon_sqd.qubit.matrix_elements_from_pauli" isDedicatedPage={true} github="https://github.com/Qiskit/qiskit-addon-sqd/tree/main/qiskit_addon_sqd/qubit.py#L179-L252" signature="matrix_elements_from_pauli(bitstring_matrix, pauli)">
  Find the sparse matrix elements of a Pauli operator in the subspace defined by the bitstrings.

  The sparse matrix, `A`, defined by the outputs represents an `NxN` matrix s.t. `N` is the number of rows in `bitstring_matrix`. The rows of `A` represent the input configurations, and the columns represent the connected component associated with the configuration in the corresponding row. The output arrays define the sparse matrix, `A`, as follows:

  `A[rows[k], cols[k]] = amplutides[k]`.

  <Admonition title="Note" type="note">
    The bitstrings in the `bitstring_matrix` must be unique and sorted in ascending order according to their unsigned integer representation. Otherwise the projection will return wrong results. This function does not explicitly check for uniqueness and order because this can be rather time consuming. See [`qiskit_addon_sqd.qubit.sort_and_remove_duplicates()`](qubit-sort-and-remove-duplicates "qiskit_addon_sqd.qubit.sort_and_remove_duplicates") for a simple way to ensure your bitstring matrix is well-formatted.
  </Admonition>

  <Admonition title="Note" type="note">
    This function relies on `jax` to efficiently perform some calculations. `jax` converts the bit arrays to `int64_t`, which means the bit arrays in `bitstring_matrix` may not have length greater than `63`.
  </Admonition>

  **Parameters**

  *   **bitstring\_matrix** ([*ndarray*](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v2.1)")) – A 2D array of `bool` representations of bit values such that each row represents a single bitstring. The bitstrings in the matrix must be sorted according to their unsigned integer representations. Otherwise the projection will return wrong results.
  *   **pauli** ([*Pauli*](/api/qiskit/qiskit.quantum_info.Pauli "(in Qiskit v1.2)")) – A Pauli operator for which to find connected elements

  **Returns**

  *   The complex amplitudes corresponding to the nonzero matrix elements
  *   The row indices corresponding to non-zero matrix elements
  *   The column indices corresponding to non-zero matrix elements

  **Raises**

  [**ValueError**](https://docs.python.org/3/library/exceptions.html#ValueError "(in Python v3.13)") – Bitstrings (rows) in `bitstring_matrix` must have length \< `64`.

  **Return type**

  [tuple](https://docs.python.org/3/library/stdtypes.html#tuple "(in Python v3.13)")\[[*ndarray*](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v2.1)"), [*ndarray*](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v2.1)"), [*ndarray*](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray "(in NumPy v2.1)")]
</Function>

