---
title: setup_lse
description: API reference for qiskit_addon_mpf.static.setup_lse
in_page_toc_min_heading_level: 1
python_api_type: function
python_api_name: qiskit_addon_mpf.static.setup_lse
---

<span id="setup-lse" />

# setup\_lse

<Function id="qiskit_addon_mpf.static.setup_lse" isDedicatedPage={true} github="https://github.com/Qiskit/qiskit-addon-mpf/tree/main/qiskit_addon_mpf/static/lse.py#L63-L131" signature="setup_lse(trotter_steps, *, order=1, symmetric=False)">
  Return the linear system of equations for computing the static MPF coefficients.

  This function constructs the following linear system of equations:

$$
A x = b,
$$

  with

$$
\begin{split}A_{0,j} &= 1 \\
A_{i>0,j} &= k_{j}^{-(\chi + s(i-1))} \\
b_0 &= 1 \\
b_{i>0} &= 0\end{split}
$$

  where \$\chi\$ is the `order`, \$s\$ is \$2\$ if `symmetric` is `True` and \$1\$ oterhwise, \$k\_\{j}\$ are the `trotter_steps`, and \$x\$ are the variables to solve for. The indices \$i\$ and \$j\$ start at \$0\$.

  Here is an example:

  ```python
  >>> from qiskit_addon_mpf.static import setup_lse
  >>> lse = setup_lse([1,2,3], order=2, symmetric=True)
  >>> print(lse.A)
  [[1.         1.         1.        ]
   [1.         0.25       0.11111111]
   [1.         0.0625     0.01234568]]
  >>> print(lse.b)
  [1. 0. 0.]
  ```

  **Parameters**

  *   **trotter\_steps** ([*list*](https://docs.python.org/3/library/stdtypes.html#list "(in Python v3.13)")*\[*[*int*](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")*] |* [*Parameter*](https://www.cvxpy.org/api_reference/cvxpy.expressions.html#cvxpy.expressions.constants.parameter.Parameter "(in CVXPY v1.5)")) – the sequence of trotter steps from which to build \$A\$. Rather than a list of integers, this may also be a [`Parameter`](https://www.cvxpy.org/api_reference/cvxpy.expressions.html#cvxpy.expressions.constants.parameter.Parameter "(in CVXPY v1.5)") instance of the desired size. In this case, the constructed [`LSE`](qiskit_addon_mpf.static.LSE "qiskit_addon_mpf.static.LSE") is parameterized whose values must be assigned before it can be solved.
  *   **order** ([*int*](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")) – the order of the individual product formulas making up the MPF.
  *   **symmetric** ([*bool*](https://docs.python.org/3/library/functions.html#bool "(in Python v3.13)")) – whether the individual product formulas making up the MPF are symmetric. For example, the Lie-Trotter formula is not symmetric, while Suzuki-Trotter is.

  **Returns**

  An [`LSE`](qiskit_addon_mpf.static.LSE "qiskit_addon_mpf.static.LSE").

  **Return type**

  [*LSE*](qiskit_addon_mpf.static.LSE "qiskit_addon_mpf.static.lse.LSE")
</Function>

