---
title: Qiskit 2.0 feature migration guide
description: Description of feature changes introduced in Qiskit 2.0 and how to update your code to work with them.
---

{/* cspell:ignore nbqa, ipynb, tqdm */}

# Qiskit 2.0 feature changes

This guide describes migration paths for the most important feature changes in Qiskit 2.0, organized by module.
Use the table of contents on the right side to navigate to the module you are interested in.

<span id="qiskit.transpiler"></span>
## qiskit.transpiler

<span id="generate_preset_pass_manager"></span>
### generate_preset_pass_manager interface

Qiskit v2.0.0 includes a series of updates to the preset pass manager interface (that is, the
[`generate_preset_pass_manager`](/api/qiskit/qiskit.transpiler.generate_preset_pass_manager) and 
[`transpile`]((/api/qiskit/qiskit.compiler.transpile)) functions) that affect the 
handling of loose constraint inputs, such as `coupling_map` or `basis_gates`. The number of 
transpilation use cases where loose constraints are accepted has been reduced in favor of the 
`target` and `backend` inputs (where `backend` is a [`BackendV2`](/api/qiskit/qiskit.providers.fake_provider.BackendV2) that 
contains a [`Target`](/api/qiskit/qiskit.transpiler.Target) instance), 
which allow for a more expressive communication of these constraints.

The following examples show the main changes and suggested alternatives for migrating. Note that all 
of the migration tips below apply to both `transpile` and `generate_preset_pass_manager`:

1. The `backend_properties` input argument is no longer supported, and the `BackendProperties` class has 
   been removed. You should use the `target` or `backend` arguments instead to communicate
   gate durations and errors. There are multiple paths for constructing a custom [`Target`](/api/qiskit/qiskit.transpiler.Target):
  
  a. Build a target from scratch and add the relevant errors and durations to the corresponding gates:
    
    ```python
    from qiskit.transpiler import Target, InstructionProperties, generate_preset_pass_manager
    from qiskit.circuit.library import XGate, CXGate

    target = Target(num_qubits=2)
    target.add_instruction(CXGate(), {(0, 1): InstructionProperties(error=.0001, duration=5e-7)})
    target.add_instruction(
        XGate(),
        {
            (0,): InstructionProperties(error=.00001, duration=5e-8),
            (1,): InstructionProperties(error=.00002, duration=6e-8)
        }
    )

    pm = generate_preset_pass_manager(target=target)
    ```

  b. Use [`GenericBackendV2`](/api/qiskit/qiskit.providers.fake_provider.GenericBackendV2) to quickly build a 
     generic target with pre-filled errors and durations. These can also be updated post-construction:

    ```python
    from qiskit.providers.fake_provider import GenericBackendV2
    from qiskit.transpiler import generate_preset_pass_manager

    target = GenericBackendV2(num_qubits=2, basis_gates=["x", "cx"]).target
    target.update_instruction_properties("x", (0,), InstructionProperties(0.00001))
    target.update_instruction_properties("x", (1,), InstructionProperties(0.00002))
    target.update_instruction_properties("cx", (0, 1), InstructionProperties(0.0001))

    pm = generate_preset_pass_manager(target=target)
    ```

2. The `instruction_durations` and `timing_constraints` input arguments are no longer supported. You should use the 
  `target` or `backend` arguments instead. The alternatives are constructing a custom [`Target`](/api/qiskit/qiskit.transpiler.Target) from
  scratch, constructing a generic backend, and, in addition to these, it is possible to build a custom target with 
  `instruction_durations` and/or `timing_constraints` using the `Target.from_configuration` method:

    ```python
    from qiskit.transpiler import Target, generate_preset_pass_manager
    from qiskit.transpiler.timing_constraints import TimingConstraints
    from qiskit.transpiler.instruction_durations import InstructionDurations

    instruction_durations = InstructionDurations([("x", None, 200), ("cx", None, 1000)], dt=1e-7)

    timing_constraints = TimingConstraints(
            granularity=1, min_length=1, pulse_alignment=1, acquire_alignment=1
        )

    target = Target.from_configuration(num_qubits=2, 
                                        basis_gates=["x", "cx"], 
                                        instruction_durations=instruction_durations, 
                                        timing_constraints=timing_constraints)
    
    pm = generate_preset_pass_manager(target=target)
    ```

3. Providing `coupling_map` and/or `basis_gates` along with a `backend` is discouraged, and from 
  v2.0 a `UserWarning` will be raised. In these cases there are multiple sources of truth, 
  and information such as gate errors and durations from the backend cannot be resolved based on the
  information given.
  The suggested alternative is to define a custom target that combines the chosen constraints either
  from scratch, using [`Target.from_configuration`](/api/qiskit/qiskit.transpiler.Target#from_configuration) or [`GenericBackendV2`](/api/qiskit/qiskit.providers.fake_provider.GenericBackendV2). 

- The `basis_gates` argument no longer accepts custom basis gates. The suggested alternative
  is the `target` argument, which can be built from scratch or through [`Target.from_configuration`](/api/qiskit/qiskit.transpiler.Target#from_configuration) 
  such as:

    ```python
    from qiskit.circuit.library import XGate
    from qiskit.transpiler.target import Target

    basis_gates = ["my_x", "cx"]
    custom_name_mapping = {"my_x": XGate()}
    target = Target.from_configuration(
        basis_gates=basis_gates, num_qubits=2, custom_name_mapping=custom_name_mapping
    )
    pm = generate_preset_pass_manager(target=target)
    ```

- The input combination where a custom `coupling_map` is provided with either a `backend` or `basis_gates`
  that contain gates with 3 or more qubits is no longer allowed. The coupling map
  does not provide the necessary connectivity details to be able to determine the  action of the gate.
  In these cases, the recommended migration path is the creation of a custom target from scratch.

- The `inst_map` argument has been removed without alternative. It was used to provide pulse information
  to the transpiler, and the full `qiskit.pulse` module has been removed.